'use strict';
//variables
const inputSearch = document.querySelector('.js-input');
const btn = document.querySelector('.js-btn');
const container = document.querySelector('.js-list');
const url = '//api.tvmaze.com/search/shows?q=girls';
const containerFav = document.querySelector('.js-fav');

//arrays vacios de las dos secciones: encontrados y favoritos
let sectionShows = [];
let sectionFav = [];

// funcion API - fetch girls
// function getInfoApi() {
//   let url = `//api.tvmaze.com/search/shows?q=girls`;
//   fetch(url)
//     .then((response) => response.json())
//     .then((dataGirls) => {
//       console.log(dataGirls);
//       renderShowList(dataGirls);
//     });
// }
// getInfoApi();

// funcion pintar una serie
function renderShows(data) {
  let html = '';
  html += `<ul id=${data.show.id} class="js-show-one"><li><h2>${data.show.name}</h2>`;
  if (data.show.image !== null) {
    html += `<img title="${data.show.name}" src="${data.show.image.medium}" alt="${data.show.name}">`;
  } else {
    html += `<img title="${data.show.name}" src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="${data.show.name}"/>`;
  }
  html += `</li></ul>`;

  return html;
}
// funcion pintar la lista de series
function renderShowList(showList) {
  for (const oneShow of showList) {
    container.innerHTML += renderShows(oneShow);
  }
  addEventstoShows();
}

//funcion clic fav
function handleFav(event) {
  console.log(event.currentTarget.id);
  const idShowClick = event.currentTarget.id;
  //buscar la info del fav que seleccionemos
  const foundShow = sectionShows.find((item) => (item.id = idShowClick));
  console.log(foundShow);
  sectionFav.push(foundShow);
  console.log(sectionFav);
  //comprobar si estÃ¡ ya pintada en el listado de

  //pintar favoritos en su lista
  //   containerFav.innerHTML += renderShows(foundShow);
}
//funcion para seleccionar todas las series que aparecen
function addEventstoShows() {
  const allShows = document.querySelectorAll('.js-show-one');
  console.log(allShows);
  for (const item of allShows) {
    item.addEventListener('click', handleFav);
  }
}

//funcion busqueda y boton
function searchShow() {
  const searchValue = inputSearch.value;
  const url2 = `https://api.tvmaze.com/search/shows?q=${searchValue}`;
  fetch(url2)
    .then((response) => response.json())
    .then((dataShows) => {
      sectionShows = dataShows;
      console.log(sectionShows);
      renderShowList(sectionShows);
    });
}

function handleSearch(event) {
  event.preventDefault();
  searchShow();
}

//evento boton buscar
btn.addEventListener('click', handleSearch);
